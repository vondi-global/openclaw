# vondi-storefront — Приложение точки выдачи

## Контекст

Приложение для планшета (Android, ландшафтная ориентация).
Устанавливается на фиксированное устройство в точке выдачи.
Оператор — сотрудник партнёрского склада или ПВЗ.

## Экраны

```
app/
├── (auth)/
│   └── login.tsx          # Авторизация оператора точки
├── (tabs)/
│   ├── index.tsx          # Главный: список ожидающих заказов
│   ├── scan.tsx           # Сканер (приём / выдача)
│   └── search.tsx         # Поиск заказа вручную
├── order/
│   └── [id].tsx           # Детали заказа + действия
└── _layout.tsx
```

## Планшетный UI

- Минимальный размер элементов: 48x48dp (пальцевое управление)
- Шрифт: минимум 18sp для основного контента
- Две колонки на главном экране (список + детали)
- Кнопки крупные, подписи чёткие

```typescript
// Пример layout для планшета (landscape)
<View style={{ flexDirection: 'row', flex: 1 }}>
  <View style={{ width: '40%' }}>  {/* Список заказов */}
    <OrderList />
  </View>
  <View style={{ width: '60%' }}>  {/* Детали + действия */}
    <OrderDetails />
  </View>
</View>
```

## Пользовательские сценарии

### US-1: Приём посылки на точку

1. Курьер привозит посылки
2. Оператор открывает вкладку "Сканер"
3. Сканирует штрихкод каждой посылки
4. Система подтверждает → посылка числится на точке
5. Покупатель получает SMS/push о готовности

### US-2: Выдача заказа покупателю

1. Покупатель приходит, называет номер заказа или телефон
2. Оператор ищет заказ (сканером QR из приложения покупателя ИЛИ поиском вручную)
3. Проверяет личность (опционально — паспорт)
4. Нажимает "Выдать" → подтверждение
5. Статус заказа → "issued"

### US-3: Просроченные заказы

1. Заказы хранятся N дней (по условиям сервиса)
2. Просроченные — выделены красным
3. Оператор инициирует возврат через приложение

## API вызовы

Верифицировано из `/p/github.com/vondi-global/pvz/internal/http/handlers/operator_handler.go`

```
// Список посылок на точке
GET /api/v1/operator/inventory?status=awaiting_pickup

// Поиск посылки
GET /api/v1/operator/inventory/search?q=<штрихкод или номер>

// Приём посылки от курьера
POST /api/v1/operator/handovers/:id/accept

// Валидация кода выдачи (QR покупателя)
POST /api/v1/operator/pickup/validate

// Выдача посылки покупателю
POST /api/v1/operator/pickup/complete

// Профиль оператора
GET /api/v1/operator/me

// Начало смены
POST /api/v1/operator/shift/start

// Статистика точки
GET /api/v1/operator/stats
```

**ВАЖНО:** PVZ Service работает с посылками (parcels), не заказами (orders).
Интеграция с заказами монолита (MonolithClient) — заглушки, не реализована.
Проверять тела запросов через реальный handler-код перед использованием.

## Компоненты

### OrderListItem

```typescript
interface Order {
  id: string;
  externalId: string; // Номер заказа для покупателя
  recipientName: string;
  recipientPhone: string;
  barcode: string;
  status: "waiting" | "issued" | "expired" | "returned";
  arrivedAt: string;
  expiresAt: string;
  isExpired: boolean;
  daysLeft: number;
}
```

### ScannerOverlay

Полноэкранный сканер с рамкой наводки и звуковым сигналом при успехе.

## Режим киоска (опционально)

Планшет можно зафиксировать в одном приложении (Android kiosk mode):

- Отключить выход из приложения
- Автоматический перезапуск при краше
- Настраивается через MDM или Android Device Policy

Этот режим — опция для будущего, не приоритет MVP.
